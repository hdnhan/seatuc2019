% 6 pages max
\documentclass[twocolumn]{article}
\input{packages_and_definitions}

\title{\bf Numerical simulation of heat transfer problem by Freefem++ software}
\author{Ta Thi Thanh Mai\thanks{email: abc}\and Ho Duc Nhan\thanks{email: abc}\and Tran Minh Tam\thanks{email: abc}}
%\thanksmarkseries{arabic}
\date{\footnotesize\textit{School of Applied Mathematics and Informatics, Hanoi University of Science and Technology, 1 Dai Co Viet street, Hai Ba Trung District, Hanoi, Vietnam}}
\justifying
% ---------------------------------------------
\begin{document}
\twocolumn[
	\maketitle
	\begin{@twocolumnfalse}
		\rule{\textwidth}{.1pt}
		\begin{abstract}
			content...
		\end{abstract}
		\vspace{1ex}
		\noindent \textit{Keywords: Inverse source problems, least squares method, Tikhonov regularization, conjugate gradient method.}
		\rule{\textwidth}{.1pt}
		\vspace{2mm}
	\end{@twocolumnfalse}
]
\saythanks

% --------------------------------------------------------------------
\section{Introduction}
% --------------------------------------------------------------------

Let $\Omega \subset \mathbb{R}^d,\, d\in \mathbb{N^+}$ be a bounded domain with a boundary $\Gamma$ and endow the cylinder $Q=\Omega\times (0,\, T]$ and lateral surface area $S=\Gamma \times (0,\, T]$ where $T>0$. 
\\
Consider the heat equation:
\begin{align}\label{1.1}
	\frac{\partial u(x, t)}{\partial t}+\mathcal{L}u(x, t)=F(x, t), \quad(x, t)\in Q,
\end{align}
with the Dirichlet boundary and initial conditions, respectively
\begin{align}
	u(x, t)&=u_D(x, t),\quad(x, t)\in S, \label{1.2}\\
	u(x, 0)&=u_0(x),\quad\quad\, x\in \Omega,\label{1.3}
\end{align}
where
\begin{align*}
	&\mathcal{L}u = -\sum_{i, j=1}^{d}\frac{\partial}{\partial x_i}\left(a_{ji}\frac{\partial u}{\partial x_j}\right)+a_0u,\\
	&a_{ji}\in L^{\infty}(Q),\, a_{ij}=a_{ji},\; \forall i, j\in \{1, 2, ..., d\},\\
	&\lambda_1\left\|\xi\right\|^2\leq \sum_{i, j=1}^{d}a_{ij}\xi_i\xi_j\leq \lambda_2\left\|\xi\right\|^2,\; \forall \xi\in\mathbb{R}^d,\\
	&a_0\in L^{\infty}(Q),\; 0\leq a_0(x, t)\leq \mu_1,\; (x, t)\in Q,\\ 
	&u_0\in L^2(\Omega),\;u_D\in L^2(S),
\end{align*}
with $\lambda_1$ and $\lambda_2$ are positive constants and $\mu_1\geq 0$.
\\
The problem is that to determine $u$ when all data $a_{ji},\,a_0,\,u_0,\,u_D$ and $F$ in \eqref{1.1} - \eqref{1.2} - \eqref{1.3} are given called \textbf{\textit{direct problem}}. 
%But in practice, we miss one of the data above such as  the right hand side $F$ of \eqref{1.1} known for heat source. The problem identifying $F$ when some additional observations on the solution $u$ available called \textbf{\textit{inverse problem}}. We suppose that the heat source following the form $F(x, t)=f(x, t)q(x, t)+g(x, t)$, where $q(x, t),\, g(x, t)$ are given. Find $f(x, t)$ if $\omega(x, t)=u(x, t)$ is given on $Q$. 
% --------------------------------------------------------------------
\section{Numerical method} 
% --------------------------------------------------------------------
\subsection{Variational problem}
% --------------------------------------------------------------------

Find $u(.,t)\in H^1(\Omega)$ such that
\begin{align}\label{2.1}
	\left\langle \frac{\partial u}{\partial t}, v \right\rangle+a\left(u, v\right)=\left\langle F, v \right\rangle,\; \forall v\in H^1(\Omega),
\end{align} 
\begin{align}\label{2.2}
	u(x, 0)=u_0(x), \; x\in \Omega,
\end{align}
where 
$$a\left(u, v\right)=\int_{\Omega}\left[\sum_{i, j=1}^{d}a_{ji}\frac{\partial u}{\partial x_i}\frac{\partial v}{\partial x_j}+a_0uv\right]dx,$$
$$\left\langle \varphi, v \right\rangle=\int_{\Omega}\varphi vdx.$$
\subsection{Finite element method}
Now we present a fully discrete finite element approximation for the variational problem \eqref{2.1} by the Crank-Nicolson method as follows:
\\
For \textit{spatial approximation}, let $\mathcal{T}_h$ be a triangulation of $\Omega$ and define a piecewise linear finite element space $V_h \subset H^1(\Omega)$ by
$$V_h=\left\{v_h:v_h\in C(\overline{\Omega}), v_h|_K\in P_1(K), \forall K\in \mathcal{T}_h\right\},$$
where $P_1(K)$ is a continuous piecewise linear polynomial on the element $K$. 
\\
For \textit{temporal discretization}, discrete $[0, T]$ uniformly into $M$ steps, $t_n=n\Delta t,\, n=0, 1, \dots, M$ with the time step size $\Delta t = T/M$. We define a function $\varphi(x, t)$ and $\varphi(x, t_n)=\varphi^n(x)$.
\\
Find $u^n_h\in V_h$ for $n=1, 2, \dots, M$ such that
\begin{align}\label{2.3}
	&\langle d_tu^n_h, v_h \rangle+a\left(\theta u^n_h+(1-\theta)u^{n-1}_h, v_h\right)\notag\\
	&\qquad\quad=\left\langle \theta F^n+(1-\theta)F^{n-1}, v_h \right\rangle, \; \forall v_h\in V_h,
\end{align}
and the initial condition 
\begin{align}\label{2.4}
	u^0_h=u_0,
\end{align}
where $d_tu^n_h=\frac{u^n_h-u^{n-1}_h}{\Delta t}, \; n=1, 2, ..., M.$

The discrete variational problem \eqref{2.3} admits a unique solution $u^n_h\in V_h$, see \eqref{}. Let $u_h(x, t)$ be the linear interpolation of $u_h^n$ with respect to $t$. 
For $x\in \Omega,\, t\in [t_{n-1}, t_n]$, we have
\begin{align*}
	u_h(x, t)=\frac{t-t_{n-1}}{\Delta t}u_h^{n-1}+\frac{t_n-t}{\Delta t}u_h^{n}.
\end{align*}
\begin{dl}\label{dl2.1}
	Let $u(x, t)$ be the solution of variational problem \eqref{2.1} - \eqref{2.2} and $u^n_h\in V_h$ for $n=1, 2, \dots, M$ be the solution for \eqref{2.3}. Then there holds the error estimate, see \eqref{}
	\begin{align}\label{2.5}
		\left\|u_h-u\right\|_{L^2(Q)}=O\left(h^2+\Delta t^2\right),
	\end{align}
	where $h$ is the mesh size.
\end{dl}



% --------------------------------------------------------------------
\section{Tests and discussion}
% --------------------------------------------------------------------
\input{result}


% --------------------------------------------------------------------
\section{Conclusion}
% --------------------------------------------------------------------


% --------------------------------------------------------------------
% biblio
% --------------------------------------------------------------------
\bibliographystyle{plain}
\bibliography{references}{}
\vfill

\end{document}
