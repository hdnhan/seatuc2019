-- FreeFem++ v  3.610001 (date jeu. 12 juil. 2018 15:05:23)
 Load: lg_fem lg_mesh lg_mesh3 eigenvalue
    1 : load "msh3"(load: loadLibary C:\Program Files (x86)\FreeFem++\\.\msh3 = 0)
    2 : load "medit"(load: loadLibary C:\Program Files (x86)\FreeFem++\\.\medit = 0)
    3 :
    4 : int nn = 64;
    5 : int Nt = nn;
    6 : int Nx = nn, Ny = nn;
    7 : int[int] labels = [1, 1, 1, 1];
    8 : mesh Th = square(Nx, Ny, label = labels);
    9 : fespace Vh(Th, P1);
   10 :
   11 : real T = 0.1, dt = T / Nt;
   12 : mesh3 Th3 = cube(Nx, Ny, Nt, [x, y, T * z]);
   13 : fespace Vh3(Th3, P1);
   14 : Vh3 uu;
   15 : real b = -sqrt(5);
   16 : Vh3 wb = exp(b * pi^2 * z) * sin(pi * x) * sin(pi * y);
   17 : Vh3 ue = -1/(2 + b) * pi^2 * wb(x, y, z);
   18 : Vh3 fe = -pi^4 * wb(x, y, z);
   19 :
   20 :
   21 :
   22 : Vh uprev = ue(x, y, 0);
   23 : Vh fprev = fe(x, y, 0);
   24 : Vh u, v;
   25 :
   26 : for(int ny = 0; ny <= Ny; ny++){
   27 :         for(int nx = 0; nx <= Nx; nx++){
   28 :                 uu[][ny * (Nx + 1) + nx] = uprev[][ny * (Nx + 1) + nx];
   29 :         }
   30 : }
   31 :
   32 : macro grad(u) [dx(u), dy(u)] )   [dx(u), dy(u)]//
   33 :
   34 : for(int nt = 1; nt <= Nt; nt++){
   35 :
   36 :         Vh fnext = fe(x, y, nt * dt);
   37 :
   38 :         solve CrankNicolson(u, v, solver = CG) =
   39 :                         int2d(Th)(u * v / dt + 0.5 * grad(u)   [dx(u), dy(u)]' * grad(v)   [dx(v), dy(v)])
   40 :                         + int2d(Th)(-uprev * v / dt + 0.5 * grad(uprev)   [dx(uprev), dy(uprev)] '* grad(v)   [d@2Îx(v), dy(v)])
   41 :                         - int2d(Th)(0.5 * (fprev + fnext) * v)
   42 :                         +on(1, u = 0);
   43 :                         //- int1d(Th, 1, 2, 3, 4)((dx(uprev) * N.x + dy(uprev) * N.y) * v);
   44 :
   45 :         for(int ny = 0; ny <= Ny; ny++){
   46 :                 for(int nx = 0; nx <= Nx; nx++){
   47 :                         uu[][nt * (Nx + 1) * (Ny + 1) + ny * (Nx + 1) + nx] = u[][ny * (Nx + 1) + nx];
   48 :                 }
   49 :         }
   50 :
   51 :         fprev = fnext;
   52 :         uprev = u;
   53 : }
   54 :
   55 : cout << "Erorr in L2: " << sqrt(int3d(Th3)((uu - ue) ^ 2)) << endl;  sizestack + 1024 =6072  ( 5048 )
 
  -- Square mesh : nb vertices  =4225 ,  nb triangles = 8192 ,  nb boundary edges 256
  Enter: BuildCube: 6
    kind = 6 n tet Cube = 6 / n slip 6 70
  Cube  nv=274625 nt=1572864 nbe=49152
  Out:  BuildCube
  -- FESpace: Nb of Nodes 274625 Nb of DoF 274625
  -- Solve :
          min -1.26469e-033  max 40.3903
  -- Solve :
          min -1.19053e-033  max 39.0204
  -- Solve :
          min -1.15163e-033  max 37.697
  -- Solve :
          min -1.11024e-033  max 36.4184
  -- Solve :
          min -1.06482e-033  max 35.1832
  -- Solve :
          min -1.03487e-033  max 33.9899
  -- Solve :
          min -9.8737e-034  max 32.8371
  -- Solve :
          min -9.64492e-034  max 31.7233
  -- Solve :
          min -9.17738e-034  max 30.6474
  -- Solve :
          min -8.98918e-034  max 29.6079
  -- Solve :
          min -8.54519e-034  max 28.6037
  -- Solve :
          min -8.37907e-034  max 27.6335
  -- Solve :
          min -7.96654e-034  max 26.6963
  -- Solve :
          min -7.81185e-034  max 25.7908
  -- Solve :
          min -7.43352e-034  max 24.916
  -- Solve :
          min -7.28468e-034  max 24.0709
  -- Solve :
          min -6.94023e-034  max 23.2545
  -- Solve :
          min -6.79475e-034  max 22.4658
  -- Solve :
          min -6.48217e-034  max 21.7038
  -- Solve :
          min -6.33939e-034  max 20.9676
  -- Solve :
          min -6.05588e-034  max 20.2564
  -- Solve :
          min -5.91611e-034  max 19.5694
  -- Solve :
          min -5.65856e-034  max 18.9056
  -- Solve :
          min -5.52259e-034  max 18.2644
  -- Solve :
          min -5.28792e-034  max 17.6449
  -- Solve :
          min -5.15672e-034  max 17.0464
  -- Solve :
          min -4.94201e-034  max 16.4682
  -- Solve :
          min -4.81649e-034  max 15.9096
  -- Solve :
          min -4.61911e-034  max 15.37
  -- Solve :
          min -4.50005e-034  max 14.8486
  -- Solve :
          min -4.31765e-034  max 14.345
  -- Solve :
          min -4.20556e-034  max 13.8584
  -- Solve :
          min -4.0362e-034  max 13.3884
  -- Solve :
          min -3.93126e-034  max 12.9342
  -- Solve :
          min -3.77335e-034  max 12.4955
  -- Solve :
          min -3.67534e-034  max 12.0717
  -- Solve :
          min -3.52773e-034  max 11.6622
  -- Solve :
          min -3.43604e-034  max 11.2666
  -- Solve :
          min -3.29798e-034  max 10.8845
  -- Solve :
          min -3.21176e-034  max 10.5153
  -- Solve :
          min -3.08286e-034  max 10.1586
  -- Solve :
          min -3.00123e-034  max 9.81402
  -- Solve :
          min -2.88128e-034  max 9.48112
  -- Solve :
          min -2.80355e-034  max 9.15952
  -- Solve :
          min -2.69237e-034  max 8.84883
  -- Solve :
          min -2.61813e-034  max 8.54867
  -- Solve :
          min -2.5154e-034  max 8.2587
  -- Solve :
          min -2.44446e-034  max 7.97856
  -- Solve :
          min -2.34972e-034  max 7.70792
  -- Solve :
          min -2.28202e-034  max 7.44647
  -- Solve :
          min -2.19473e-034  max 7.19388
  -- Solve :
          min -2.13024e-034  max 6.94985
  -- Solve :
          min -2.04981e-034  max 6.71411
  -- Solve :
          min -1.98854e-034  max 6.48636
  -- Solve :
          min -1.91439e-034  max 6.26633
  -- Solve :
          min -1.85632e-034  max 6.05377
  -- Solve :
          min -1.78789e-034  max 5.84842
  -- Solve :
          min -1.73299e-034  max 5.65003
  -- Solve :
          min -1.66977e-034  max 5.45838
  -- Solve :
          min -1.61797e-034  max 5.27322
  -- Solve :
          min -1.55951e-034  max 5.09434
  -- Solve :
          min -1.51073e-034  max 4.92153
  -- Solve :
          min -1.45662e-034  max 4.75458
  -- Solve :
          min -1.41077e-034  max 4.5933
Erorr in L2: 0.00138152
times: compile 0.261s, execution 8.247s,  mpirank:0
 ######## We forget of deleting   737 Nb pointer,   0Bytes  ,  mpirank 0, memory leak =0
 CodeAlloc : nb ptr  3192,  size :395952 mpirank: 0
Ok: Normal End
 try getConsole D:\Study\HUST\FEM\Co Mai\seatuc2019\freefem++\crank-nicolson2D.edp
