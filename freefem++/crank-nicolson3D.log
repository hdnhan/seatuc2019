-- FreeFem++ v  3.610001 (date jeu. 12 juil. 2018 15:05:23)
 Load: lg_fem lg_mesh lg_mesh3 eigenvalue
    1 : load "msh3"(load: loadLibary C:\Program Files (x86)\FreeFem++\\.\msh3 = 0)
    2 : load "medit"(load: loadLibary C:\Program Files (x86)\FreeFem++\\.\medit = 0)
    3 :
    4 : int nn = 32;
    5 : int Nt = nn;
    6 : int Nx = nn, Ny = nn, Nz = nn;
    7 : int[int] labels = [1, 1, 1, 1, 1, 1];
    8 : mesh3 Th = cube(Nx, Ny, Nz, label = labels);
    9 : fespace Vh(Th, P1);
   10 :
   11 : real T = 1, dt = T / Nt;
   12 : Vh u0 = sin(pi * x) * sin(pi * y) * sin(pi * z);
   13 : Vh u = u0, v, uold;
   14 :
   15 : Vh f0 = (1 + 3 * pi ^ 2) * u0;
   16 : macro grad(u) [dx(u), dy(u), dz(u)] )   [dx(u), dy(u), dz(u)]//
   17 : for(real t = dt; t <= T; t += dt){
   18 :         func ue = exp(t) * sin(pi * x) * sin(pi * y) * sin(pi * z);
   19 :         func f = (1 + 3 * pi ^ 2) * ue;
   20 :         uold = u;
   21 :
   22 :         solve CrankNicolson(u, v, solver = CG) =
   23 :                         int3d(Th)(u * v / dt + 0.5 * grad(u)    [dx(u), dy(u), dz(u)]' * grad(v)    [dx(v), dy(v), dz(v)])
   24 :                         + int3d(Th)(-uold * v / dt + 0.5 * grad(uold)    [dx(uold), dy(uold), dz(uold)] '* grad(v)    [dx(v), dy(v), dz(v)])
   25 :                         - int3d(Th)(0.5 * (f + f0) * v) + on(1, u = 0);
   26 :         f0 = f;
   27 :         if (t == T){
   28 :                 cout << "L2 Error: " << sqrt(int3d(Th)((ue - u) ^ 2)) << endl;
   29 :         }
   30 : } sizestack + 1024 =8344  ( 7320 )
 
  Enter: BuildCube: 6
    kind = 6 n tet Cube = 6 / n slip 6 70
  Cube  nv=35937 nt=196608 nbe=12288
  Out:  BuildCube
  -- FESpace: Nb of Nodes 35937 Nb of DoF 35937
  -- Solve :
          min -8.10846e-037  max 1.02997
  -- Solve :
          min -8.31348e-037  max 1.06203
  -- Solve :
          min -8.60462e-037  max 1.0955
  -- Solve :
          min -8.86002e-037  max 1.13019
  -- Solve :
          min -9.15745e-037  max 1.16603
  -- Solve :
          min -9.4128e-037  max 1.20304
  -- Solve :
          min -9.74854e-037  max 1.24122
  -- Solve :
          min -1.00457e-036  max 1.28062
  -- Solve :
          min -1.035e-036  max 1.32127
  -- Solve :
          min -1.07001e-036  max 1.36321
  -- Solve :
          min -1.1016e-036  max 1.40649
  -- Solve :
          min -1.13897e-036  max 1.45113
  -- Solve :
          min -1.17304e-036  max 1.4972
  -- Solve :
          min -1.21083e-036  max 1.54472
  -- Solve :
          min -1.24928e-036  max 1.59376
  -- Solve :
          min -1.28871e-036  max 1.64435
  -- Solve :
          min -1.32982e-036  max 1.69655
  -- Solve :
          min -1.37193e-036  max 1.7504
  -- Solve :
          min -1.41556e-036  max 1.80596
  -- Solve :
          min -1.4602e-036  max 1.86329
  -- Solve :
          min -1.5111e-036  max 1.92244
  -- Solve :
          min -1.55347e-036  max 1.98346
  -- Solve :
          min -1.60887e-036  max 2.04642
  -- Solve :
          min -1.6519e-036  max 2.11138
  -- Solve :
          min -1.71275e-036  max 2.17841
  -- Solve :
          min -1.75796e-036  max 2.24756
  -- Solve :
          min -1.82332e-036  max 2.3189
  -- Solve :
          min -1.8705e-036  max 2.39251
  -- Solve :
          min -1.94095e-036  max 2.46846
  -- Solve :
          min -1.99133e-036  max 2.54682
  -- Solve :
          min -2.06075e-036  max 2.62766
  -- Solve :
          min -2.12256e-036  max 2.71107
L2 Error: 0.00529606
times: compile 0.098s, execution 131.437s,  mpirank:0
 ######## We forget of deleting   304 Nb pointer,   0Bytes  ,  mpirank 0, memory leak =0
 CodeAlloc : nb ptr  3079,  size :393360 mpirank: 0
Ok: Normal End
 try getConsole D:\Study\HUST\FEM\Co Mai\seatuc\freefem++\crank-nicolson3D.edp
